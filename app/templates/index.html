<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>顔タイプ診断アプリ</title>
    <link rel="stylesheet" href="{{ url_for('static', path='style.css') }}" />
    <link href="https://fonts.googleapis.com/earlyaccess/nicomoji.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@500;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="app-frame">
      <section class="screen active" id="screen-home">
        <div class="title-wrap">
          <div class="title-easy wf-nicomoji">かんたん</div>
          <h1 class="title-main">顔診断アプリ</h1>
        </div>

        <p>あなたの顔タイプを診断します！</p>
        <p>下のボタンを押して早速スタート♪</p>

        <div class="nav-buttons single">
          <button class="button next-button" data-target="screen-camera">
            診断スタート ⇀
          </button>
        </div>
      </section>

      <section class="screen" id="screen-camera">
        <h2 class="heading" data-number="01">顔画像の撮影</h2>

        <div class="camera-area">
          <div class="camera-preview">
            <video id="camera" autoplay muted playsinline></video>
            <button class="button shoot-button" data-target="screen-confirm">
              <img src="{{ url_for('static', path='img/camera-icon.png') }}" width="40" alt="撮影" />
            </button>
          </div>

          <p>目と鼻のラインを合わせて撮影してね♪</p>

          <div class="nav-buttons single">
            <button class="button" id="upload-button" aria-label="ライブラリから選択">
              <svg width="96" height="96" viewBox="0 0 96 96" fill="none" aria-hidden="true" focusable="false">
                <defs>
                  <linearGradient id="upload-card" x1="12" y1="12" x2="84" y2="84" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#7C3AED" />
                    <stop offset="1" stop-color="#A855F7" />
                  </linearGradient>
                  <linearGradient id="upload-page" x1="24" y1="24" x2="72" y2="72" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#FFFFFF" stop-opacity="0.95" />
                    <stop offset="1" stop-color="#E9D5FF" />
                  </linearGradient>
                </defs>
                <rect x="8" y="8" width="80" height="80" rx="16" fill="url(#upload-card)" />
                <rect x="20" y="20" width="56" height="56" rx="12" fill="url(#upload-page)" stroke="#F5F3FF" stroke-width="2" />
                <path d="M32 38H64" stroke="#7C3AED" stroke-width="4" stroke-linecap="round" />
                <path d="M32 48H64" stroke="#7C3AED" stroke-width="4" stroke-linecap="round" />
                <path d="M32 58H52" stroke="#7C3AED" stroke-width="4" stroke-linecap="round" />
                <path d="M56 26V58L64 50L72 58V26" fill="#F59E0B" stroke="#FBBF24" stroke-width="3" stroke-linejoin="round" />
              </svg>
            </button>
          </div>

          <div class="nav-buttons single">
            <button class="button prev-button" data-target="screen-home">
              ↼ 戻る
            </button>
          </div>
        </div>
      </section>

      <input type="file" id="upload-input" accept="image/*" style="display:none" />

      <section class="screen" id="screen-confirm">
        <h2 class="heading" data-number="02">画像の確認</h2>

        <p>この画像で問題ないかな？☺</p>
        <div class="image-preview">撮影した画像</div>

        <div class="nav-buttons">
          <button class="button prev-button" data-target="screen-camera">
            ↼ 撮り直す
          </button>
          <button class="button next-button" id="go-feature">
            次へ ⇀
          </button>
        </div>
      </section>

      <section class="screen" id="screen-feature">
        <h2 class="heading" data-number="03">特徴点の確認</h2>

        <p>特徴点の位置を確認してね！</p>
        <div class="feature-container">
          <canvas id="feature-canvas" style="width: 100%; border-radius: 16px; background: #eee;"></canvas>
        </div>

        <div class="nav-buttons">
          <button class="button prev-button" id="retry-analysis">
            再認識
          </button>
          <button class="button next-button" id="start-diagnosis">
            診断開始 ⇀
          </button>
        </div>
      </section>

      <section class="screen" id="screen-loading">
        <div class="loading-container">
          <div class="loading-spinner"></div>
          <p class="loading-text">Loading…</p>
        </div>
      </section>

      <section class="screen" id="screen-result">
        <h2 class="heading">診断結果</h2>

        <div class="result-layout">
          <div class="result-image-wrapper">
            <canvas id="result-canvas"></canvas>
          </div>
          <div class="result-info">
            <p id="result-type" class="result-type">--</p>
          </div>
        </div>

        <div class="nav-buttons">
          <button class="button next-button" data-target="screen-camera">
            もう一度診断
          </button>
          <button class="button next-button" data-target="screen-home">
            アプリ終了
          </button>
        </div>
      </section>
    </div>

    <script src="{{ url_for('static', path='script.js') }}" defer></script>
  </body>
</html>
